{
  "solver": {
    "lr_policy": "fixed",
    "display": 1000,
    "max_iter": 1000000,
    "gpu": [
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15
    ],
    "batchsize": 32768,
    "batchsize_eval": 32768,
    "snapshot": 10000000,
    "snapshot_prefix": "./",
    "eval_interval": 6400,
    "eval_batches": 2721,
    "mixed_precision": 1024,
    "cuda_graph": false,
    "eval_metrics": [
      "AUC:0.8025"
    ]
  },
  "optimizer": {
    "type": "SGD",
    "sgd_hparam": {
      "learning_rate": 18.0,
      "atomic_update": true,
      "warmup_steps": 8000,
      "decay_start": 70000,
      "decay_steps": 30000,
      "decay_power": 2.0,
      "end_lr": 0.0
    }
  },
  "layers": [
    {
      "name": "data",
      "type": "Data",
      "format": "Raw",
      "num_samples": 4195196928,
      "slot_size_array": [
        39884406,
        39043,
        17289,
        7420,
        20263,
        3,
        7120,
        1543,
        63,
        38532951,
        2953546,
        403346,
        10,
        2208,
        11938,
        155,
        4,
        976,
        14,
        39979771,
        25641295,
        39664984,
        585935,
        12972,
        108,
        36
      ],
      "source": "/etc/workspace/dataset/train_data.bin",
      "eval_num_samples": 89137319,
      "eval_source": "/etc/workspace/dataset/test_data.bin",
      "check": "None",
      "label": {
        "top": "label",
        "label_dim": 1
      },
      "dense": {
        "top": "dense",
        "dense_dim": 13
      },
      "sparse": [
        {
          "top": "data1",
          "type": "LocalizedSlot",
          "max_feature_num_per_sample": 26,
          "max_nnz": 1,
          "slot_num": 26
        }
      ]
    },
    {
      "name": "sparse_embedding1",
      "type": "LocalizedSlotSparseEmbeddingOneHot",
      "bottom": "data1",
      "top": "sparse_embedding1",
      "sparse_embedding_hparam": {
        "slot_size_array": [
          39884406,
          39043,
          17289,
          7420,
          20263,
          3,
          7120,
          1543,
          63,
          38532951,
          2953546,
          403346,
          10,
          2208,
          11938,
          155,
          4,
          976,
          14,
          39979771,
          25641295,
          39664984,
          585935,
          12972,
          108,
          36
        ],
        "embedding_vec_size": 128,
        "combiner": 0
      }
    },
    {
      "name": "adaptorstart1",
      "type": "AdaptorStart",
      "bottom": "dense",
      "top": [
        "adaptorstart11",
        "adaptorstart12"
      ]
    },
    {
      "name": "fusedfc1",
      "type": "FusedInnerProduct",
      "bottom": [
        "adaptorstart11",
        "adaptorstart12"
      ],
      "top": [
        "fusedfc11",
        "fusedfc12"
      ],
      "fc_param": {
        "num_output": 512
      }
    },
    {
      "name": "fusedfc2",
      "type": "FusedInnerProduct",
      "bottom": [
        "fusedfc11",
        "fusedfc12"
      ],
      "top": [
        "fusedfc21",
        "fusedfc22"
      ],
      "fc_param": {
        "num_output": 256
      }
    },
    {
      "name": "fusedfc3",
      "type": "FusedInnerProduct",
      "bottom": [
        "fusedfc21",
        "fusedfc22"
      ],
      "top": [
        "fusedfc31",
        "fusedfc32"
      ],
      "fc_param": {
        "num_output": 128
      }
    },
    {
      "name": "adaptorend1",
      "type": "AdaptorEnd",
      "bottom": [
        "fusedfc31",
        "fusedfc32"
      ],
      "top": "adaptorend1"
    },
    {
      "name": "interaction1",
      "type": "Interaction",
      "bottom": [
        "adaptorend1",
        "sparse_embedding1"
      ],
      "top": "interaction1"
    },
    {
      "name": "adaptorstart2",
      "type": "AdaptorStart",
      "bottom": "interaction1",
      "top": [
          "adaptorstart21",
          "adaptorstart22"
      ]
  },
  {
      "name": "fusedfc4",
      "type": "FusedInnerProduct",
      "bottom": [
          "adaptorstart21",
          "adaptorstart22"
      ],
      "top": [
          "fusedfc41",
          "fusedfc42"
      ],
      "fc_param": {
          "num_output": 1024
      }
  },
  {
      "name": "fusedfc5",
      "type": "FusedInnerProduct",
      "bottom": [
          "fusedfc41",
          "fusedfc42"
      ],
      "top": [
          "fusedfc51",
          "fusedfc52"
      ],
      "fc_param": {
          "num_output": 1024
      }
  },
  {
      "name": "fusedfc6",
      "type": "FusedInnerProduct",
      "bottom": [
          "fusedfc51",
          "fusedfc52"
      ],
      "top": [
          "fusedfc61",
          "fusedfc62"
      ],
      "fc_param": {
          "num_output": 512
      }
  },
  {
      "name": "fusedfc7",
      "type": "FusedInnerProduct",
      "bottom": [
          "fusedfc61",
          "fusedfc62"
      ],
      "top": [
          "fusedfc71",
          "fusedfc72"
      ],
      "fc_param": {
          "num_output": 256
      }
  },
  {
      "name": "adaptorend2",
      "type": "AdaptorEnd",
      "bottom": [
          "fusedfc71",
          "fusedfc72"
      ],
      "top": "adaptorend2"
  },
    {
      "name": "fc8",
      "type": "InnerProduct",
      "bottom": "adaptorend2",
      "top": "fc8",
      "fc_param": {
        "num_output": 1
      }
    },
    {
      "name": "loss",
      "type": "BinaryCrossEntropyLoss",
      "bottom": [
        "fc8",
        "label"
      ],
      "top": "loss"
    }
  ]
}