{
    "solver": {
        "lr_policy": "fixed",
        "display": 200,
        "max_iter": 18000,
        "gpu": [
            0
        ],
        "batchsize": 2048,
        "snapshot": 10000000,
        "snapshot_prefix": "./",
        "eval_interval": 1000,
        "eval_batches": 2048,
        "mixed_precision": 1024
    },
    "optimizer": {
        "type": "Adam",
        "update_type": "Global",
        "adam_hparam": {
            "learning_rate": 0.001,
            "beta1": 0.9,
            "beta2": 0.999,
            "epsilon": 0.0001
        }
    },
    "layers": [
        {
            "name": "data",
            "type": "Data",
            "source": "./file_list.txt",
            "eval_source": "./file_list_test.txt",
            "check": "Sum",
            "label": {
                "top": "label",
                "label_dim": 1
            },
            "dense": {
                "top": "dense",
                "dense_dim": 13
            },
            "sparse": [
                {
                    "top": "data1",
                    "type": "LocalizedSlot",
                    "max_feature_num_per_sample": 26,
                    "max_nnz": 1,
                    "slot_num": 26
                }
            ]
        },
        {
            "name": "sparse_embedding1",
            "type": "LocalizedSlotSparseEmbeddingHash",
            "bottom": "data1",
            "top": "sparse_embedding1",
            "sparse_embedding_hparam": {
                "max_vocabulary_size_per_gpu": 1737709,
                "embedding_vec_size": 128,
                "combiner": 0
            }
        },
        {
          "name": "adaptorstart1",
          "type": "AdaptorStart",
          "bottom": "dense",
          "top": ["adaptorstart11","adaptorstart12"]
        },

        {
            "name": "fusedfc1",
            "type": "FusedInnerProduct",
            "bottom": ["adaptorstart11","adaptorstart12"],
            "top": ["fusedfc11","fusedfc12"],
             "fc_param": {
           "num_output": 512
             }
        },
    	{
            "name": "fusedfc2",
            "type": "FusedInnerProduct",
            "bottom": ["fusedfc11","fusedfc12"],
            "top": ["fusedfc21","fusedfc22"],
             "fc_param": {
           "num_output": 256
             }
        },
        {
          "name": "fusedfc3",
          "type": "FusedInnerProduct",
          "bottom": ["fusedfc21","fusedfc22"],
          "top": ["fusedfc31","fusedfc32"],
          "fc_param": {
              "num_output": 128
          }
        },
        {
            "name": "adaptorend1",
            "type": "AdaptorEnd",
            "bottom": ["fusedfc31","fusedfc32"],
            "top": "adaptorend1"
        },
        {
            "name": "interaction1",
            "type": "Interaction",
            "bottom": [
                "adaptorend1",
                "sparse_embedding1"
            ],
            "top": "interaction1"
        },
        {
          "name": "adaptorstart2",
          "type": "AdaptorStart",
          "bottom": "interaction1",
          "top": ["adaptorstart21","adaptorstart22"]
        },
        {
          "name": "fusedfc4",
          "type": "FusedInnerProduct",
          "bottom": ["adaptorstart21","adaptorstart22"],
          "top": ["fusedfc41","fusedfc42"],
          "fc_param": {
              "num_output": 1024
          }
        },
        {
          "name": "fusedfc5",
          "type": "FusedInnerProduct",
          "bottom": ["fusedfc41","fusedfc42"],
          "top": ["fusedfc51","fusedfc52"],
          "fc_param": {
              "num_output": 1024
          }
        },
        {
          "name": "fusedfc6",
          "type": "FusedInnerProduct",
          "bottom": ["fusedfc51","fusedfc52"],
          "top": ["fusedfc61","fusedfc62"],
          "fc_param": {
              "num_output": 512
          }
        },
        {
          "name": "fusedfc7",
          "type": "FusedInnerProduct",
          "bottom": ["fusedfc61","fusedfc62"],
          "top": ["fusedfc71","fusedfc72"],
          "fc_param": {
              "num_output": 256
          }
        },
        {     
          "name": "adaptorend2",
          "type": "AdaptorEnd",
          "bottom": ["fusedfc71","fusedfc72"],
          "top": "adaptorend2"
        },
        {
            "name": "fc8",
            "type": "InnerProduct",
            "bottom": "adaptorend2",
            "top": "fc8",
            "fc_param": {
                "num_output": 1
            }
        },
        {
            "name": "loss",
            "type": "BinaryCrossEntropyLoss",
            "bottom": [
                "fc8",
                "label"
            ],
            "top": "loss"
        }
    ]
}