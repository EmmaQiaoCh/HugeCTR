{
  "solver": {
    "lr_policy": "fixed",
    "display": 200,
    "max_iter": 3000,
    "gpu": [
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7
    ],
    "batchsize": 16384,
    "snapshot": 10000000,
    "snapshot_prefix": "./",
    "eval_interval": 1000,
    "eval_batches": 2048,
    "mixed_precision": 1024
  },
  "optimizer": {
    "type": "Adam",
    "update_type": "Global",
    "adam_hparam": {
      "learning_rate": 0.001,
      "beta1": 0.9,
      "beta2": 0.999,
      "epsilon": 0.0001
    }
  },
  "layers": [
    {
      "name": "data",
      "type": "Data",
      "source": "./file_list.txt",
      "eval_source": "./file_list_test.txt",
      "check": "Sum",
      "label": {
        "top": "label",
        "label_dim": 1
      },
      "dense": {
        "top": "dense",
        "dense_dim": 13
      },
      "sparse": [
        {
          "top": "wide_data",
          "type": "DistributedSlot",
          "max_feature_num_per_sample": 30,
          "slot_num": 1
        },
        {
          "top": "deep_data",
          "type": "LocalizedSlot",
          "max_feature_num_per_sample": 30,
          "slot_num": 26
        }
      ]
    },
    {
      "name": "sparse_embedding2",
      "type": "DistributedSlotSparseEmbeddingHash",
      "bottom": "wide_data",
      "top": "sparse_embedding2",
      "sparse_embedding_hparam": {
        "max_vocabulary_size_per_gpu": 290350,
        "embedding_vec_size": 1,
        "combiner": 0
      }
    },
    {
      "name": "sparse_embedding1",
      "type": "LocalizedSlotSparseEmbeddingHash",
      "bottom": "deep_data",
      "top": "sparse_embedding1",
      "plan_file": "all2all_plan_bi_1.json",
      "sparse_embedding_hparam": {
        "max_vocabulary_size_per_gpu": 828103,
        "embedding_vec_size": 16,
        "combiner": 0
      }
    },
    {
      "name": "reshape1",
      "type": "Reshape",
      "bottom": "sparse_embedding1",
      "top": "reshape1",
      "leading_dim": 416
    },
    {
      "name": "reshape2",
      "type": "Reshape",
      "bottom": "sparse_embedding2",
      "top": "reshape2",
      "leading_dim": 1
    },
    {
      "name": "concat1",
      "type": "Concat",
      "bottom": [
        "reshape1",
        "dense"
      ],
      "top": "concat1"
    },
    {
      "name": "adaptorstart1",
      "type": "AdaptorStart",
      "bottom": "concat1",
      "top": [
          "adaptorstart11",
          "adaptorstart12"
      ]
    },
    {
      "name": "fusedfc1",
      "type": "FusedInnerProduct",
      "bottom": [
          "adaptorstart11",
          "adaptorstart12"
      ],
      "top": [
          "fusedfc11",
          "fusedfc12"
      ],
      "fc_param": {
          "num_output": 1024
      }
    },
    {
      "name": "adaptorend1",
      "type": "AdaptorEnd",
      "bottom": [
          "fusedfc11",
          "fusedfc12"
      ],
      "top": "adaptorend1"
    },
    {
      "name": "dropout1",
      "type": "Dropout",
      "rate": 0.5,
      "bottom": "adaptorend1",
      "top": "dropout1"
    },
    {
      "name": "adaptorstart2",
      "type": "AdaptorStart",
      "bottom": "dropout1",
      "top": [
          "adaptorstart21",
          "adaptorstart22"
      ]
    },
    {
      "name": "fusedfc2",
      "type": "FusedInnerProduct",
      "bottom": [
          "adaptorstart21",
          "adaptorstart22"
      ],
      "top": [
          "fusedfc21",
          "fusedfc22"
      ],
      "fc_param": {
          "num_output": 1024
      }
    },
    {
      "name": "adaptorend2",
      "type": "AdaptorEnd",
      "bottom": [
          "fusedfc21",
          "fusedfc22"
      ],
      "top": "adaptorend2"
    },
    {
      "name": "dropout2",
      "type": "Dropout",
      "rate": 0.5,
      "bottom": "adaptorend2",
      "top": "dropout2"
    },
    {
      "name": "adaptorstart3",
      "type": "AdaptorStart",
      "bottom": "dropout2",
      "top": [
          "adaptorstart31",
          "adaptorstart32"
      ]
    },
    {
      "name": "fusedfc3",
      "type": "FusedInnerProduct",
      "bottom": [
          "adaptorstart31",
          "adaptorstart32"
      ],
      "top": [
          "fusedfc31",
          "fusedfc32"
      ],
      "fc_param": {
          "num_output": 1024
      }
    },
    {
      "name": "adaptorend3",
      "type": "AdaptorEnd",
      "bottom": [
          "fusedfc31",
          "fusedfc32"
      ],
      "top": "adaptorend3"
    },
    {
      "name": "dropout3",
      "type": "Dropout",
      "rate": 0.5,
      "bottom": "adaptorend3",
      "top": "dropout3"
    },
    {
      "name": "adaptorstart4",
      "type": "AdaptorStart",
      "bottom": "dropout3",
      "top": [
          "adaptorstart41",
          "adaptorstart42"
      ]
    },
    {
      "name": "fusedfc4",
      "type": "FusedInnerProduct",
      "bottom": [
          "adaptorstart41",
          "adaptorstart42"
      ],
      "top": [
          "fusedfc41",
          "fusedfc42"
      ],
      "fc_param": {
          "num_output": 1024
      }
    },
    {
      "name": "adaptorend4",
      "type": "AdaptorEnd",
      "bottom": [
          "fusedfc41",
          "fusedfc42"
      ],
      "top": "adaptorend4"
    },
    {
      "name": "dropout4",
      "type": "Dropout",
      "rate": 0.5,
      "bottom": "adaptorend4",
      "top": "dropout4"
    },
    {
      "name": "adaptorstart5",
      "type": "AdaptorStart",
      "bottom": "dropout4",
      "top": [
          "adaptorstart51",
          "adaptorstart52"
      ]
    },
    {
      "name": "fusedfc5",
      "type": "FusedInnerProduct",
      "bottom": [
          "adaptorstart51",
          "adaptorstart52"
      ],
      "top": [
          "fusedfc51",
          "fusedfc52"
      ],
      "fc_param": {
          "num_output": 1024
      }
    },
    {
      "name": "adaptorend5",
      "type": "AdaptorEnd",
      "bottom": [
          "fusedfc51",
          "fusedfc52"
      ],
      "top": "adaptorend5"
    },
    {
      "name": "dropout5",
      "type": "Dropout",
      "rate": 0.5,
      "bottom": "adaptorend5",
      "top": "dropout5"
    },
    {
      "name": "adaptorstart6",
      "type": "AdaptorStart",
      "bottom": "dropout5",
      "top": [
          "adaptorstart61",
          "adaptorstart62"
      ]
    },
    {
      "name": "fusedfc6",
      "type": "FusedInnerProduct",
      "bottom": [
          "adaptorstart61",
          "adaptorstart62"
      ],
      "top": [
          "fusedfc61",
          "fusedfc62"
      ],
      "fc_param": {
          "num_output": 1024
      }
    },
    {
      "name": "adaptorend6",
      "type": "AdaptorEnd",
      "bottom": [
          "fusedfc61",
          "fusedfc62"
      ],
      "top": "adaptorend6"
    },
    {
      "name": "dropout6",
      "type": "Dropout",
      "rate": 0.5,
      "bottom": "adaptorend6",
      "top": "dropout6"
    },
    {
      "name": "adaptorstart7",
      "type": "AdaptorStart",
      "bottom": "dropout6",
      "top": [
          "adaptorstart71",
          "adaptorstart72"
      ]
    },
    {
      "name": "fusedfc7",
      "type": "FusedInnerProduct",
      "bottom": [
          "adaptorstart71",
          "adaptorstart72"
      ],
      "top": [
          "fusedfc71",
          "fusedfc72"
      ],
      "fc_param": {
          "num_output": 1024
      }
    },
    {
      "name": "adaptorend7",
      "type": "AdaptorEnd",
      "bottom": [
          "fusedfc71",
          "fusedfc72"
      ],
      "top": "adaptorend7"
    },
    {
      "name": "dropout7",
      "type": "Dropout",
      "rate": 0.5,
      "bottom": "adaptorend7",
      "top": "dropout7"
    },
    {
      "name": "fc8",
      "type": "InnerProduct",
      "bottom": "dropout7",
      "top": "fc8",
      "fc_param": {
        "num_output": 1
      }
    },
    {
      "name": "add1",
      "type": "Add",
      "bottom": [
        "fc8",
        "reshape2"
      ],
      "top": "add1"
    },
    {
      "name": "loss",
      "type": "BinaryCrossEntropyLoss",
      "bottom": [
        "add1",
        "label"
      ],
      "top": "loss"
    }
  ]
}